# Lab 1

## Lab_02-1.malware
* Main function:
  * What is the address of main?
    * 0x4011a0
  * What does this function do?
    * It checks if it can connect to `http://reversing.rocks/` and if it can't, it exits with error code 1. If it can, it calls a function with the actual program logic.
  * Are there any interesting strings? If so, what are they?
    * Yes, there's the `http://reversing.rocks/`, `text/html`, and `POST`, which leads me to believe it's going to send a POST request to that url to update some data. There's also a long string of XML that has "requestedPrivileges", "security", "trustInfo", and "assembly", which leads me to believe it's going to try to try to do privilege escalation on the computer that it's running on.
* Looking at subroutine at 0x401130:
  * What are the arguments to InternetConnectA? What do they mean?
    * `hInternet`: a Handle returned by the previous `InternetOpenA` call
    * `lpszServerName`: a pointer to a null terminated string of the hostname of the server to connect to
    * `nServerPort`: the port of the server to connect to
    * `lpszUserName`: a pointer to a null terminated string that specifies the name of the user to log on as
    * `lpszPassword`: a pointer to a null terminated string that specifies the password of the user to log on as
    * `dwService`: The type of service to access
    * `dwFlags`: Some options for the specific service that the user chose in `dwService`
    * `dwContext`: A pointer to a variable that can be used to identify the application context for the returned handle
  * What does this function do?
    * Opens an FTP or HTTP session for a hostname, logging in as the user that's specified by `lpszUserName`
* Looking at subroutine at 0x401000:
  * What code constructs are used in this function?
    * if statements, and loops
  * What imported functions are called?
    * `FindFirstFileA`, `HttpOpenRequestA`, `HttpSendRequestA`, `InternetWriteFile`, `FindNextFileA`, `HttpEndRequestA`, `InternetCloseHandle`, and `FindClose`
  * What does this subroutine do?
    * It reads a bunch of files and sends the contents to a server using a POST request
* What does this malware do?
  * It sends data from the files on your computer to someone

## Lab_02-2.malware
* Main function:
  * What imported functions are called?
    * `AllocConsole`, `ShowWindow`, `FindWindow`, and `Z8get_keysv`
  * What do these functions do?
    * `AllocConsole`: Allocates a new console, which provides I/O services to a program
    * `ShowWindow`: Sets a window's show state
    * `FindWindow`: Returns a handle to a window with the specified name and class
  * Any interesting strings?
    * "Started logging" and a filename "\\Windows\\lzwindowlz.av"
* Looking at the subroutine at 0x40135C:
  * What imported function are called?
    * `GetAsyncKeyState`, `fopen`, `fputc`, `fclose`, `fseek`, `ftell`, and `fread`
  * What code constructs are used here?
    * Switch statement, if statement, loop
* What does this malware do? It is a keylogger
  * What signatures would you propose?
    * "my.inbox.com", "unknown-g@inbox.com", "unknown-g@hotmail.co.uk"
  * Why are they useful signatures?
    * They help figure out who the malware author is, and what email services they use. Their email address can be used to see if other malware is by the same author.
  * Does the sample create any files? If so, what are they used for?
    * No, unless "\\Windows\\lzwindowlz.av" is not already a file. It writes keystrokes there.

