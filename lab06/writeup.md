## Lab_06-1.malware

1. What is the address of the `__main` function?

   ​	`0x00403420`

   1. What imported function does `main` call?

      ​	`GetCommandLineA` - gets a list of command line arguments

      ​	`GetStartupInfoA` - gets metadata about the process, such as the name of the computer it's running on, info on the window it's running in, etc.

      ​	`GetModuelHandleA` - retrieves a handle to a module given a module name

2. Looking at the subroutine at `0x00402C6E`:

   1. Is there an encoding/decoding function? If so:
      1. What is the address of the function? - `0x004012ec`
      2. What is being encoded/decoded?  - The first argument is decoded with the second argument as a key and the third argument as a length.  By setting breakpoints and examining the decoded values in memory, they seem to be additional DLLs which are loaded.
   2. What is the very large basic block doing?
      1. The large basic block simply decodes a long list of strings, placing each in a different global variable. By setting a breakpoint in this function and examining the decrypted memory contents, we can see that they seem to be decoding additional DLLs to load.

3. Looking at the subroutine at `0x004023D0`:

   1. What are all of the `GetProcAddress` calls doing?
      1. These seem to be getting the address of decoded function names from the decoded DLLs which are loaded in right beforehand



## Changes

Update IDA plugins

- I like replica for finding crypto constants/etc., but there are other good plugins for this too
- I believe ghidra has a built in entropy viewer, but I usually use binwalk



The last question shouldn't specify a length



## Malicious Behavior

Obfuscating imports - 10

Checking for sandbox - 6 (common for DRM/anticheat engines)

