# Lab 4

## Lab_04-1.malware
* Set a breakpoint at 0x401092, what is this sample calling?
  * `kernel32.GetProcAddress`

* What is being called at 0x4010A6? What is the callee doing?
  * The callee is VirtualAlloc. it's allocating (reserving and committing) 0xB000 bytes at address 0xC000000.

* What is sub_401360 doing? What about sub_401372 and sub_401388?
  * sub_401360: Calls Kernel32 GetProcAddress
  * sub_401372: Calls RegCreateKeyA
  * sub_401388: Calls User32 GetProcAddress

* What Windows API functions did the sample import?
  * GetProcAddress, RegCreateKeyA, VirtualAlloc, GetModuleFileNameA, GetWindowsDirectoryA, CopyFileA, RegSetKeyValueA, RegCloseKey, LoadLibraryA, MessageBoxA, ExitProcess

* How did you find the imported functions?
  * I set breakpoints on all of the calls and wrote down the name of the functions that it called

* What does this sample do?
  * Copies itself to `C:\Windows\virus.exe`, sets a registry key to auto-launch it, pops up a dialogue box that says "Infected!" and then exits.

## Lab_04-2.malware
* What is the address of the win/lose function?
  * 0x401020

* What does this sample do with the user input?
  * It reverses the nibbles of each character entered

* What is the address of the encrypted flag?
  * 0x403018

* Flag?
  * flag{Pra1se_th3_Sun!}

